class DeviceDetector{static detectDevice(e,t,i,n,a=null){const o=e.toLowerCase(),s=[/android.+mobile/,/iphone/,/ipod/,/blackberry/,/iemobile/,/opera mini/,/mobile/,/palm/,/windows ce/,/symbian/,/webos/,/bada/,/tizen/,/kaios/].some(e=>e.test(o)),c=[/ipad/,/android(?!.*mobile)/,/tablet/,/kindle/,/silk/,/playbook/,/rim tablet/].some(e=>e.test(o)),r=[/smart-tv/,/googletv/,/appletv/,/hbbtv/,/pov_tv/,/netcast/,/roku/,/dlnadoc/,/ce-html/,/xbox/,/playstation/].some(e=>e.test(o)),l=[/nintendo/,/xbox/,/playstation/,/vita/,/3ds/,/wii/].some(e=>e.test(o)),d=t*i,p=Math.max(t,i)/Math.min(t,i),v=n>0,h={mobile:0,tablet:0,desktop:0,tv:0,console:0,wearable:0};s&&(h.mobile+=40),c&&(h.tablet+=40),r&&(h.tv+=50),l&&(h.console+=50),t<=480?(h.mobile+=30,h.wearable+=20):t<=768?(h.mobile+=25,h.tablet+=15):t<=1024?(h.tablet+=25,h.desktop+=15):t<=1920?(h.desktop+=30,h.tv+=10):(h.desktop+=25,h.tv+=20),d<4e5?(h.mobile+=20,h.wearable+=15):d>2e6&&(h.desktop+=15,h.tv+=15),v?(h.mobile+=20,h.tablet+=20,h.desktop+=5):(h.desktop+=15,h.tv+=10,h.console+=10),p>2&&(h.tv+=15,h.desktop+=10),o.includes("mac")&&v&&t>=768&&(h.tablet+=30,h.mobile-=10),o.includes("android")&&!o.includes("mobile")&&t>600&&(h.tablet+=25,h.mobile-=15);const b=Object.entries(h).sort(([,e],[,t])=>t-e)[0];return{deviceType:b[0],confidence:Math.min(b[1],100),scores:h,metadata:{screenSize:this.getScreenSizeCategory(t,i),screenClass:this.getScreenClass(t,i),touchCapable:v,aspectRatio:Math.round(100*p)/100,screenArea:d,pixelDensity:this.getPixelDensityClass(t,i)},raw:{userAgent:o,screenWidth:t,screenHeight:i,touchPoints:n}}}static getScreenSizeCategory(e,t){const i=Math.max(e,t);return i<=480?"extra_small":i<=768?"small":i<=1024?"medium":i<=1440?"large":i<=1920?"extra_large":"ultra_large"}static getScreenClass(e,t){const i=e*t;return i<3e5?"compact":i<8e5?"standard":i<2e6?"large":"ultra_large"}static getPixelDensityClass(e,t){const i=e*t;return i<5e5?"low_res":i<1e6?"standard_res":i<25e5?"high_res":i<8e6?"very_high_res":"ultra_high_res"}}class EnhancedAnalyticsClient extends AnalyticsClient{constructor(){super(),this.deviceInfo=this.detectDeviceInfo()}detectDeviceInfo(){const e=DeviceDetector.detectDevice(navigator.userAgent,screen.width,screen.height,navigator.maxTouchPoints||0,screen.orientation?screen.orientation.type:null);return{device_type:e.deviceType,device_confidence:e.confidence,device_scores:e.scores,screen_size_category:e.metadata.screenSize,screen_class:e.metadata.screenClass,touch_capable:e.metadata.touchCapable,aspect_ratio:e.metadata.aspectRatio,pixel_density_class:e.metadata.pixelDensity,is_portrait:screen.height>screen.width,is_retina:window.devicePixelRatio>1.5,supports_orientation:"orientation"in screen,supports_vibration:"vibrate"in navigator,supports_geolocation:"geolocation"in navigator,supports_notifications:"Notification"in window,supports_service_worker:"serviceWorker"in navigator,supports_web_share:"share"in navigator}}collectSessionData(){return{...super.collectSessionData(),...this.deviceInfo}}async logInteraction(e,t={}){const i={...t,device_type:this.deviceInfo.device_type,is_touch_interaction:"ontouchstart"in window,current_orientation:screen.orientation?screen.orientation.type:"unknown"};await super.logInteraction(e,i)}}document.addEventListener("DOMContentLoaded",function(){DeviceDetector.detectDevice(navigator.userAgent,screen.width,screen.height,navigator.maxTouchPoints||0);window.analyticsClient||(window.analyticsClient=new EnhancedAnalyticsClient,console.log("Enhanced analytics with device detection initialized"))});